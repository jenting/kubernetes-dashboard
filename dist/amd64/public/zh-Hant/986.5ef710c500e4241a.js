"use strict";(self.webpackChunkkubernetes_dashboard=self.webpackChunkkubernetes_dashboard||[]).push([[986],{6986:(Bt,Y,s)=>{s.r(Y),s.d(Y,{CreateModule:()=>ht});var j=s(1028),W=s(5861),Q=s(6911),L=s(833),b=s(3778),P=s(488),_=s(4650),p=s(529),H=s(8177),N=s(5938),I=s(4793);let h=(()=>{class t{constructor(e,n,o,i,E,R){this.http_=e,this.namespace_=n,this.csrfToken_=o,this.matDialog_=i,this.router_=E,this.CONFIG=R,this.isDeployInProgress_=!1}createContent(e,n=!0,o=""){var i=this;return(0,W.Z)(function*(){const E={name:o,namespace:i.namespace_.current(),content:e,validate:n};let R,S;try{const{token:m}=yield i.csrfToken_.getTokenForAction("appdeploymentfromfile").toPromise();i.isDeployInProgress_=!0,R=yield i.http_.post("api/v1/appdeploymentfromfile",E,{headers:{[i.CONFIG.csrfHeaderName]:m}}).toPromise(),R.error.length>0&&i.reportError_("Deployment has been partly completed",R.error)}catch(m){S=m}if(i.isDeployInProgress_=!1,S)throw i.reportError_("Deploying file has failed",(0,Q.Vf)(S).message),S;return R})()}deploy(e){var n=this;return(0,W.Z)(function*(){let o,i;try{const{token:E}=yield n.csrfToken_.getTokenForAction("appdeployment").toPromise();n.isDeployInProgress_=!0,o=yield n.http_.post("api/v1/appdeployment",e,{headers:{[n.CONFIG.csrfHeaderName]:E}}).toPromise()}catch(E){i=E}if(n.isDeployInProgress_=!1,i)throw n.reportError_("Deploying file has failed",(0,Q.Vf)(i).message),i;return o})()}isDeployDisabled(){return this.isDeployInProgress_}reportError_(e,n){this.matDialog_.open(b.a,{data:{title:e,message:n,confirmLabel:"OK"}})}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275inject(p.eN),_.\u0275\u0275inject(P.L),_.\u0275\u0275inject(H.Q),_.\u0275\u0275inject(N.uw),_.\u0275\u0275inject(I.Router),_.\u0275\u0275inject(L.ED))},t.\u0275prov=_.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})(),ee=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=_.\u0275\u0275defineInjector({providers:[h]}),t})();var M=s(4859);let te=(()=>{class t{constructor(e){this.data=e}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(N.WI))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-confirm-dialog"]],decls:9,vars:4,consts:[["mat-dialog-title",""],[1,"kd-dialog-text"],["mat-button","","color","secondary",3,"mat-dialog-close"],["mat-button","","color","primary",3,"mat-dialog-close"]],template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"h2",0),_.\u0275\u0275text(1),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(2,"mat-dialog-content",1),_.\u0275\u0275text(3),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(4,"mat-dialog-actions")(5,"button",2),_.\u0275\u0275text(6,"No"),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(7,"button",3),_.\u0275\u0275text(8,"Yes"),_.\u0275\u0275elementEnd()()),2&e&&(_.\u0275\u0275advance(1),_.\u0275\u0275textInterpolate(n.data.title),_.\u0275\u0275advance(2),_.\u0275\u0275textInterpolate(n.data.message),_.\u0275\u0275advance(2),_.\u0275\u0275property("mat-dialog-close",!1),_.\u0275\u0275advance(2),_.\u0275\u0275property("mat-dialog-close",!0))},directives:[N.uh,N.xY,N.H8,M.lW,N.ZT],encapsulation:2}),t})();var B=s(9646);let Z=(()=>{class t{constructor(e){this.dialog_=e}canDeactivate(e){return e.canDeactivate()?(0,B.of)(!0):this.dialog_.open(te,{data:{title:"Unsaved changes",message:"The form has not been submitted yet, do you really want to leave?"}}).afterClosed()}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275inject(N.uw))},t.\u0275prov=_.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac}),t})();var __=s(6042),C=s(6895);let ne=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=_.\u0275\u0275defineInjector({imports:[[C.CommonModule,__.m,j.K]]}),t})();var re=s(3456);let U=(()=>{class t{unloadNotification(e){this.canDeactivate()||(e.returnValue=!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=_.\u0275\u0275defineDirective({type:t,hostBindings:function(e,n){1&e&&_.\u0275\u0275listener("beforeunload",function(i){return n.unloadNotification(i)},!1,_.\u0275\u0275resolveWindow)}}),t})();var a=s(4006),K=s(5908),X=s(9335),oe=s(1230);function ae(t,r){1&t&&(_.\u0275\u0275elementStart(0,"span"),_.\u0275\u0275i18n(1,10),_.\u0275\u0275elementEnd())}function ie(t,r){1&t&&(_.\u0275\u0275elementStart(0,"span"),_.\u0275\u0275i18n(1,11),_.\u0275\u0275elementEnd())}let e_=(()=>{class t extends U{constructor(e,n,o,i){super(),this.namespace_=e,this.create_=n,this.history_=o,this.router_=i,this.created_=!1}isCreateDisabled(){return!this.file||0===this.file.content.length}create(){this.create_.createContent(this.file.content,!0,this.file.name).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[K.x]:this.namespace_.current()}})})}onFileLoad(e){this.file=e}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}canDeactivate(){return this.isCreateDisabled()||this.created_}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(P.L),_.\u0275\u0275directiveInject(h),_.\u0275\u0275directiveInject(X.q),_.\u0275\u0275directiveInject(I.Router))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create-from-file"]],viewQuery:function(e,n){if(1&e&&_.\u0275\u0275viewQuery(a.NgForm,7),2&e){let o;_.\u0275\u0275queryRefresh(o=_.\u0275\u0275loadQuery())&&(n.ngForm=o.first)}},features:[_.\u0275\u0275InheritDefinitionFeature],decls:11,vars:3,consts:function(){let r,e,n,o,i,E;return r="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#5\ufffd" + "open_in_new" + "\ufffd/#5\ufffd" + "\n            ",e="\u9078\u64C7 YAML \u6216 JSON \u6587\u4EF6",n="Upload\n",o="Cancel\n",i="\n    \u9078\u64C7 YAML \u6216 JSON \u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u8CC7\u6E90\u90E8\u7F72\u5230\u8A72\u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u9593\u3002\n  ",E="\n            \u9078\u64C7 YAML \u6216 JSON \u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u8CC7\u6E90\u90E8\u7F72\u5230\u7576\u524D\u9078\u5B9A\u7684\u547D\u540D\u7A7A\u9593\u3002\n  ",[[1,"kd-create-from-file-info"],[4,"ngIf"],["href","https://kubernetes.io/docs/tasks/run-application/run-stateless-application-deployment/","target","_blank"],r,[1,"material-icons"],["label",e,3,"onLoad"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],n,["type","button","color","primary","mat-button","",3,"click"],o,i,E]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"div",0),_.\u0275\u0275template(1,ae,2,0,"span",1),_.\u0275\u0275template(2,ie,2,0,"span",1),_.\u0275\u0275elementStart(3,"a",2),_.\u0275\u0275i18nStart(4,3),_.\u0275\u0275element(5,"i",4),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(6,"kd-upload-file",5),_.\u0275\u0275listener("onLoad",function(i){return n.onFileLoad(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(7,"button",6),_.\u0275\u0275listener("click",function(){return n.create()}),_.\u0275\u0275i18n(8,7),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(9,"button",8),_.\u0275\u0275listener("click",function(){return n.cancel()}),_.\u0275\u0275i18n(10,9),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",n.areMultipleNamespacesSelected()),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",!n.areMultipleNamespacesSelected()),_.\u0275\u0275advance(5),_.\u0275\u0275property("disabled",n.isCreateDisabled()))},directives:[C.NgIf,oe.R,M.lW],styles:[".kd-create-from-file-info[_ngcontent-%COMP%]{margin-bottom:24px;padding:0 4px}.kd-create-from-file-info[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.kd-deploy-from-file-button[_ngcontent-%COMP%]{margin-left:0}"]}),t})();var t_=s(6906),G=s(5671),n_=s(6758),r_=s(2722),o_=s(811);const le=["group"];let Ee=(()=>{class t{constructor(e,n){this.dialogRef=e,this.data=n,this.text="",this.selectedMode=G.j.YAML,this.modes=G.j,this.unsubscribe_=new n_.x}ngOnInit(){const e=this.toDeploymentConfiguration(this.data.spec);this.text=JSON.stringify(this.removeEmptyField(e)),this.buttonToggleGroup.valueChange.pipe((0,r_.R)(this.unsubscribe_)).subscribe(n=>{this.selectedMode=n,this.text&&this.updateText()})}ngOnDestroy(){this.unsubscribe_.next(),this.unsubscribe_.complete()}getSelectedMode(){return this.buttonToggleGroup.value}updateText(){this.text=this.selectedMode===G.j.YAML?(0,t_.$w)(JSON.parse(this.text)):this.toRawJSON((0,t_.zD)(this.text))}removeEmptyField(e){return JSON.parse(JSON.stringify(e),(n,o)=>{if(!(null==o||"object"==typeof o&&0===Object.entries(o).length||Array.isArray(o)&&(0===o.length||o.every(i=>null===i))))return o})}toDeploymentConfiguration(e){const n=Object.fromEntries(e.labels.map(o=>[o.key,o.value]));return{apiVersion:"apps/v1",kind:"Deployment",metadata:{name:e.name,namespace:e.namespace,labels:n},annotations:{description:e.description},spec:{replicas:e.replicas,selector:{matchLabels:n},template:{metadata:{name:e.name,labels:n},annotations:{description:e.description},spec:{containers:[{name:e.name,image:e.containerImage,command:[e.containerCommand],args:[e.containerCommandArgs],env:e.variables,resources:{requests:{cpu:e.cpuRequirement,memory:e.memoryRequirement}},securityContext:{privileged:e.runAsPrivileged}}],imagePullSecrets:[{name:e.imagePullSecret}]}}}}}toRawJSON(e){return JSON.stringify(e,null,"\t")}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(N.so),_.\u0275\u0275directiveInject(N.WI))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-preview-deploy-dialog"]],viewQuery:function(e,n){if(1&e&&_.\u0275\u0275viewQuery(le,7),2&e){let o;_.\u0275\u0275queryRefresh(o=_.\u0275\u0275loadQuery())&&(n.buttonToggleGroup=o.first)}},decls:13,vars:7,consts:function(){let r,e;return r="Preview Deployment",e="\u95DC\u9589",[["mat-dialog-title",""],r,[1,"kd-dialog-text"],["group","matButtonToggleGroup"],[3,"value","checked"],[3,"value"],[3,"text","readOnly","mode","textChange"],["mat-button","","color","primary",3,"mat-dialog-close"],e]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"h2",0),_.\u0275\u0275i18n(1,1),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(2,"mat-dialog-content",2)(3,"mat-button-toggle-group",null,3)(5,"mat-button-toggle",4),_.\u0275\u0275text(6,"YAML"),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(7,"mat-button-toggle",5),_.\u0275\u0275text(8,"JSON"),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(9,"kd-text-input",6),_.\u0275\u0275listener("textChange",function(i){return n.text=i}),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(10,"mat-dialog-actions")(11,"button",7),_.\u0275\u0275i18n(12,8),_.\u0275\u0275elementEnd()()),2&e&&(_.\u0275\u0275advance(5),_.\u0275\u0275property("value",n.modes.YAML)("checked",!0),_.\u0275\u0275advance(2),_.\u0275\u0275property("value",n.modes.JSON),_.\u0275\u0275advance(2),_.\u0275\u0275property("text",n.text)("readOnly",!0)("mode",n.getSelectedMode()),_.\u0275\u0275advance(2),_.\u0275\u0275property("mat-dialog-close",!1))},directives:[N.uh,N.xY,o_.A9,o_.Yi,G.t,N.H8,M.lW,N.ZT],encapsulation:2}),t})();var $=s(5698),a_=s(3900),A=s(1576);const se=["*"];let k=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-help-section"]],ngContentSelectors:se,decls:2,vars:0,consts:[["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column",1,"kd-help-section"]],template:function(e,n){1&e&&(_.\u0275\u0275projectionDef(),_.\u0275\u0275elementStart(0,"div",0),_.\u0275\u0275projection(1),_.\u0275\u0275elementEnd())},directives:[A.xw],styles:[".kd-help-section[_ngcontent-%COMP%]    >*{flex:1;flex-basis:auto;margin:8px 0;width:100%}.kd-help-section[_ngcontent-%COMP%]    >*:last-child{padding-left:32px}.kd-help-section[_ngcontent-%COMP%]    >*:first-child{max-width:48.5%}@media (max-width: 959px){.kd-help-section[_ngcontent-%COMP%]    >*:first-child{max-width:100%}}.kd-help-section[_ngcontent-%COMP%]   kd-port-mappings[_ngcontent-%COMP%]{margin-bottom:0;margin-top:0}"]}),t})();var d=s(9549),D=s(284);const Re=["*"];let J=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-user-help"]],ngContentSelectors:Re,decls:2,vars:0,consts:[[1,"kd-user-help"]],template:function(e,n){1&e&&(_.\u0275\u0275projectionDef(),_.\u0275\u0275elementStart(0,"div",0),_.\u0275\u0275projection(1),_.\u0275\u0275elementEnd())},styles:[".kd-user-help[_ngcontent-%COMP%]    {font-size:14px}.kd-user-help[_ngcontent-%COMP%]     .material-icons{font-size:12px;vertical-align:middle}"]}),t})();function Se(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,16),_.\u0275\u0275elementEnd())}function Te(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,17),_.\u0275\u0275elementEnd()),2&t){const e=_.\u0275\u0275nextContext();_.\u0275\u0275advance(1),_.\u0275\u0275i18nExp(e.namespaceMaxLength),_.\u0275\u0275i18nApply(1)}}function Ne(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,18),_.\u0275\u0275elementEnd())}let me=(()=>{class t{constructor(e,n,o,i,E,R,S){this.dialogRef=e,this.data=n,this.http_=o,this.csrfToken_=i,this.matDialog_=E,this.fb_=R,this.appConfig_=S,this.namespaceMaxLength=63,this.namespacePattern=new RegExp("^[a-z0-9]([-a-z0-9]*[a-z0-9])?$")}ngOnInit(){this.form=this.fb_.group({namespace:["",a.Validators.compose([a.Validators.maxLength(this.namespaceMaxLength),a.Validators.pattern(this.namespacePattern)])]})}get namespace(){return this.form.get("namespace")}createNamespace(){if(!this.form.valid)return;const e={name:this.namespace.value};this.csrfToken_.getTokenForAction("namespace").pipe((0,a_.w)(o=>this.http_.post("api/v1/namespace",{...e},{headers:(new p.WM).set(this.appConfig_.csrfHeaderName,o.token)}))).subscribe(()=>{this.dialogRef.close(this.namespace.value)},o=>{this.dialogRef.close(),this.matDialog_.open(b.a,{data:{title:"Error creating namespace",message:o.data,confirmLabel:"OK"}})})}isDisabled(){return this.data.namespaces.indexOf(this.namespace.value)>=0}cancel(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(N.so),_.\u0275\u0275directiveInject(N.WI),_.\u0275\u0275directiveInject(p.eN),_.\u0275\u0275directiveInject(H.Q),_.\u0275\u0275directiveInject(N.uw),_.\u0275\u0275directiveInject(a.FormBuilder),_.\u0275\u0275directiveInject(L.ED))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create-namespace-dialog"]],decls:28,vars:7,consts:function(){let r,e,n,o,i,E,R,S,m,c;return r="Create a new namespace",e="\u65B0\u7684\u547D\u540D\u7A7A\u9593\u5C07\u6DFB\u52A0\u5230\u53E2\u96C6\u4E2D\u3002",n="\u547D\u540D\u7A7A\u9593\u7684\u540D\u5B57",o="\u5C07\u5177\u6709\u6307\u5B9A\u540D\u7A31\u7684\u547D\u540D\u7A7A\u9593\u6DFB\u52A0\u5230\u53E2\u96C6\u4E2D\u3002",i="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#21\ufffd" + "open_in_new" + "\ufffd/#21\ufffd" + "\n            ",E=" Create ",R="Cancel",S="\n              \u540D\u7A31\u662F\u5FC5\u586B\u7684\u3002\n            ",m="\n              \u540D\u7A31\u5FC5\u9808\u5927\u65BC " + "\ufffd0\ufffd" + " \u500B\u5B57\u7B26\n            ",c="\n              \u540D\u7A31\u5FC5\u9808\u662F\u5B57\u6BCD\u6216\u8005\u6578\u5B57\uFF0C\u53EF\u4EE5\u5305\u542B\u9023\u63A5\u865F \"-\"\u3002\n            ",[["mat-dialog-title",""],r,[1,"kd-dialog-text"],e,[3,"formGroup"],["matInput","","type","text","placeholder",n,"name","namespace","formControlName","namespace","required",""],["align","end"],[4,"ngIf"],o,["href","https://kubernetes.io/docs/admin/namespaces/","target","_blank","tabindex","-1"],i,[1,"material-icons"],["mat-button","","type","submit","color","primary",3,"disabled","click"],E,["mat-button","",3,"click"],R,S,m,c]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"h4",0),_.\u0275\u0275i18n(1,1),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(2,"mat-dialog-content",2),_.\u0275\u0275elementContainerStart(3),_.\u0275\u0275elementStart(4,"div"),_.\u0275\u0275i18n(5,3),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(6,"div")(7,"form",4)(8,"kd-help-section")(9,"mat-form-field"),_.\u0275\u0275element(10,"input",5),_.\u0275\u0275elementStart(11,"mat-hint",6),_.\u0275\u0275text(12),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(13,Se,2,0,"mat-error",7),_.\u0275\u0275template(14,Te,2,1,"mat-error",7),_.\u0275\u0275template(15,Ne,2,0,"mat-error",7),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(16,"kd-user-help"),_.\u0275\u0275elementContainerStart(17),_.\u0275\u0275i18n(18,8),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(19,"a",9),_.\u0275\u0275i18nStart(20,10),_.\u0275\u0275element(21,"i",11),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()()()(),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(22,"mat-dialog-actions",6),_.\u0275\u0275elementContainerStart(23),_.\u0275\u0275elementStart(24,"button",12),_.\u0275\u0275listener("click",function(){return n.createNamespace()}),_.\u0275\u0275i18n(25,13),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(26,"button",14),_.\u0275\u0275listener("click",function(){return n.cancel()}),_.\u0275\u0275i18n(27,15),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275advance(7),_.\u0275\u0275property("formGroup",n.form),_.\u0275\u0275advance(5),_.\u0275\u0275textInterpolate2("",n.namespace.value.length," / ",n.namespaceMaxLength,""),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.namespace.errors?null:n.namespace.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.namespace.errors?null:n.namespace.errors.maxlength),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.namespace.errors?null:n.namespace.errors.pattern),_.\u0275\u0275advance(9),_.\u0275\u0275property("disabled",n.isDisabled()))},directives:[N.uh,N.xY,a.\u0275NgNoValidate,a.NgControlStatusGroup,a.FormGroupDirective,k,d.KE,D.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlName,a.RequiredValidator,d.bx,C.NgIf,d.TO,J,N.H8,M.lW],encapsulation:2}),t})();class i_{constructor(r="",e="",n=!0){this.editable=n,this.key=r,this.value=e}}var V=s(8372),v=s(4004);let Oe=(()=>{class t{constructor(e){this.http=e}validate(e){return l_(this.http,this.namespace)(e)}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(p.eN))},t.\u0275dir=_.\u0275\u0275defineDirective({type:t,selectors:[["","kdUniqueName",""]],inputs:{namespace:"namespace"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_ASYNC_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])]}),t})();function l_(t,r){return e=>e.value?t.post("api/v1/appdeployment/validate/name",{name:e.value,namespace:r}).pipe((0,V.b)(500),(0,v.U)(n=>n.valid?null:{uniqueName:e.value})):(0,B.of)(null)}class u{static namePattern(r){return r.value?new RegExp("^[a-z]([-a-z0-9]*[a-z0-9])?$").test(r.value)?null:{namePattern:{value:r.value}}:null}static isInteger(r){const e=r.value;return e?Number(e)===e&&e%1==0||!e?null:{kdValidInteger:{value:r.value}}:null}static labelKeyNameLength(r){const e=r.value,o=e.indexOf("/");return(o>-1?e.substring(o+1):e).length<=63?null:{kdValidLabelKeyPrefixLength:{value:!0}}}static labelKeyPrefixLength(r){const e=r.value,o=e.indexOf("/");return(o>-1?e.substring(0,o):"").length<=253?null:{kdValidLabelKeyPrefixLength:{value:!0}}}static labelKeyNamePattern(r){const e=r.value,o=e.indexOf("/"),i=o>-1?e.substring(o+1):e;return/^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$/.test(i)||""===e?null:{kdValidLabelKeyNamePattern:{value:!0}}}static labelKeyPrefixPattern(r){const e=r.value,o=e.indexOf("/");return o>-1&&!/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/.test(e.substring(0,o))?{kdValidLabelKeyPrefixPattern:{value:!0}}:null}static labelValuePattern(r){return/^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$/.test(r.value)?null:{kdValidLabelValuePattern:{value:!0}}}}function de(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,20),_.\u0275\u0275elementEnd())}function Ce(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,21),_.\u0275\u0275elementEnd()),2&t){const e=_.\u0275\u0275nextContext();_.\u0275\u0275advance(1),_.\u0275\u0275i18nExp(e.secretNameMaxLength),_.\u0275\u0275i18nApply(1)}}function ue(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,22),_.\u0275\u0275elementEnd())}function pe(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,23),_.\u0275\u0275elementEnd())}function Me(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,24),_.\u0275\u0275elementEnd())}let Ae=(()=>{class t{constructor(e,n,o,i,E,R,S){this.dialogRef=e,this.data_=n,this.http_=o,this.csrfToken_=i,this.matDialog_=E,this.fb_=R,this.appConfig_=S,this.secretNameMaxLength=253,this.secretNamePattern=new RegExp("^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$"),this.dataPattern=new RegExp("^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$")}ngOnInit(){this.form=this.fb_.group({secretName:["",a.Validators.compose([a.Validators.maxLength(this.secretNameMaxLength),a.Validators.pattern(this.secretNamePattern)])],data:["",a.Validators.pattern(this.dataPattern)]})}get secretName(){return this.form.get("secretName")}get data(){return this.form.get("data")}createSecret(){if(!this.form.valid)return;const e={name:this.secretName.value,namespace:this.data_.namespace,data:this.data.value};this.csrfToken_.getTokenForAction("secret").pipe((0,a_.w)(o=>this.http_.post("api/v1/secret/",{...e},{headers:(new p.WM).set(this.appConfig_.csrfHeaderName,o.token)}))).subscribe(()=>{this.dialogRef.close(this.secretName.value)},o=>{this.dialogRef.close(),this.matDialog_.open(b.a,{data:{title:"Error creating secret",message:o.data,confirmLabel:"OK"}})})}cancel(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(N.so),_.\u0275\u0275directiveInject(N.WI),_.\u0275\u0275directiveInject(p.eN),_.\u0275\u0275directiveInject(H.Q),_.\u0275\u0275directiveInject(N.uw),_.\u0275\u0275directiveInject(a.FormBuilder),_.\u0275\u0275directiveInject(L.ED))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create-secret-dialog"]],decls:39,vars:8,consts:function(){let r,e,n,o,i,E,R,S,m,c,O,g,F,f;return r="Create a new image pull secret",e="\u65B0\u7684 secret \u5C07\u6DFB\u52A0\u5230\u53E2\u96C6\u4E2D",n="Secret \u540D\u7A31",o="\u5177\u6709\u6307\u5B9A\u540D\u7A31\u7684 secret \u5C07\u6DFB\u52A0\u5230\u547D\u540D\u7A7A\u9593\u4E2D\u7684\u53E2\u96C6\u4E2D\u3002",i="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#21\ufffd" + "open_in_new" + "\ufffd/#21\ufffd" + "\n            ",E="\u6307\u5B9A\u8981\u4FDD\u7559\u7684 secret \u7684 data\u3002\u8A72\u503C\u662F .dockercfg \u6587\u4EF6\u4E2D\u7684 Base64 \u7DE8\u78BC\u5185\u5BB9",R="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#32\ufffd" + "open_in_new" + "\ufffd/#32\ufffd" + "\n            ",S="Create",m="Cancel",c="\n              \u540D\u7A31\u662F\u5FC5\u586B\u7684\u3002\n            ",O="\n              \u540D\u7A31\u5FC5\u9808\u5927\u65BC " + "\ufffd0\ufffd" + " \u500B\u5B57\u7B26\n            ",g="\n             \u540D\u7A31\u5FC5\u9808\u9075\u5FAA DNS \u57DF\u540D\u8A9E\u6CD5\uFF08\u4F8B\u5982 new.image-pull.secret\uFF09\u3002\n            ",F="\n              Data \u662F\u5FC5\u9808\u7684\u3002\n            ",f="\n              Data \u5FC5\u9808\u662F Base64 \u7DE8\u78BC\u7684\u683C\u5F0F\u3002\n            ",[["mat-dialog-title",""],r,[1,"kd-dialog-text"],e,[3,"formGroup"],["matInput","","type","text","placeholder",n,"name","secretName","formControlName","secretName","required",""],["align","end"],[4,"ngIf"],o,["href","https://kubernetes.io/docs/user-guide/secrets/","target","_blank","tabindex","-1"],i,[1,"material-icons"],["matInput","","type","text","placeholder","Image pull secret data","name","data","formControlName","data","required",""],E,["href","https://kubernetes.io/docs/user-guide/images/#specifying-imagepullsecrets-on-a-pod","target","_blank","tabindex","-1"],R,["mat-button","","type","submit","color","primary",3,"click"],S,["mat-button","",3,"click"],m,c,O,g,F,f]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"h4",0),_.\u0275\u0275i18n(1,1),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(2,"mat-dialog-content",2),_.\u0275\u0275elementContainerStart(3),_.\u0275\u0275elementStart(4,"div"),_.\u0275\u0275i18n(5,3),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(6,"div")(7,"form",4)(8,"kd-help-section")(9,"mat-form-field"),_.\u0275\u0275element(10,"input",5),_.\u0275\u0275elementStart(11,"mat-hint",6),_.\u0275\u0275text(12),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(13,de,2,0,"mat-error",7),_.\u0275\u0275template(14,Ce,2,1,"mat-error",7),_.\u0275\u0275template(15,ue,2,0,"mat-error",7),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(16,"kd-user-help")(17,"span"),_.\u0275\u0275i18n(18,8),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(19,"a",9),_.\u0275\u0275i18nStart(20,10),_.\u0275\u0275element(21,"i",11),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(22,"kd-help-section")(23,"mat-form-field"),_.\u0275\u0275element(24,"input",12),_.\u0275\u0275template(25,pe,2,0,"mat-error",7),_.\u0275\u0275template(26,Me,2,0,"mat-error",7),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(27,"kd-user-help"),_.\u0275\u0275elementContainerStart(28),_.\u0275\u0275i18n(29,13),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(30,"a",14),_.\u0275\u0275i18nStart(31,15),_.\u0275\u0275element(32,"i",11),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()()()(),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(33,"mat-dialog-actions",6),_.\u0275\u0275elementContainerStart(34),_.\u0275\u0275elementStart(35,"button",16),_.\u0275\u0275listener("click",function(){return n.createSecret()}),_.\u0275\u0275i18n(36,17),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(37,"button",18),_.\u0275\u0275listener("click",function(){return n.cancel()}),_.\u0275\u0275i18n(38,19),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275advance(7),_.\u0275\u0275property("formGroup",n.form),_.\u0275\u0275advance(5),_.\u0275\u0275textInterpolate2("",n.secretName.value.length," / ",n.secretNameMaxLength,""),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.secretName.errors?null:n.secretName.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.secretName.errors?null:n.secretName.errors.maxlength),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.secretName.errors?null:n.secretName.errors.pattern),_.\u0275\u0275advance(10),_.\u0275\u0275property("ngIf",null==n.data.errors?null:n.data.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.data.errors?null:n.data.errors.pattern))},directives:[N.uh,N.xY,a.\u0275NgNoValidate,a.NgControlStatusGroup,a.FormGroupDirective,k,d.KE,D.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlName,a.RequiredValidator,d.bx,C.NgIf,d.TO,J,N.H8,M.lW],encapsulation:2}),t})();var E_=s(3162),s_=s(5829);let Fe=(()=>{class t{constructor(e){this.http=e}validate(e){return e.value?this.http.post("api/v1/appdeployment/validate/imagereference",{reference:e.value}).pipe((0,V.b)(500),(0,v.U)(n=>n.valid?null:{validImageReference:n.reason})):(0,B.of)(null)}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(p.eN))},t.\u0275dir=_.\u0275\u0275defineDirective({type:t,selectors:[["","kdValidImageReference",""]],inputs:{namespace:"namespace"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_ASYNC_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])]}),t})(),fe=(()=>{class t{constructor(){}validate(e){return this.shouldSetWarning(e.value)?(this.hasWarning=!0,{warnThreshold:{value:"333"}}):(this.shouldRemoveWarning(e.value)&&(this.hasWarning=!1),null)}shouldSetWarning(e){return e>this.kdWarnThreshold}shouldRemoveWarning(e){return!this.hasWarning&&!this.shouldSetWarning(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=_.\u0275\u0275defineDirective({type:t,selectors:[["","kdWarnThreshold",""]],inputs:{kdWarnThreshold:"kdWarnThreshold"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])]}),t})();var Ie=s(8675),De=s(9300);let Pe=(()=>{class t{constructor(e){this.http=e}validate(e){return R_(this.http,this.isExternal)(e)}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(p.eN))},t.\u0275dir=_.\u0275\u0275defineDirective({type:t,selectors:[["","kdValidProtocol",""]],inputs:{isExternal:"isExternal"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_ASYNC_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])]}),t})();function R_(t,r){return e=>e.value?t.post("api/v1/appdeployment/validate/protocol",{protocol:e.value,isExternal:r}).pipe((0,$.q)(1)).pipe((0,V.b)(500),(0,v.U)(o=>o.valid?null:{validProtocol:!0})):(0,B.of)(null)}var S_=s(4385),T_=s(3238),w=s(7392);function he(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-option",7),_.\u0275\u0275text(1),_.\u0275\u0275elementEnd()),2&t){const e=r.$implicit;_.\u0275\u0275property("value",e),_.\u0275\u0275advance(1),_.\u0275\u0275textInterpolate1(" ",e.label," ")}}function Be(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,19),_.\u0275\u0275elementEnd())}function Ue(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,20),_.\u0275\u0275elementEnd())}function $e(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,21),_.\u0275\u0275elementEnd())}function ve(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,22),_.\u0275\u0275elementEnd())}function ye(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,23),_.\u0275\u0275elementEnd())}function Le(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,24),_.\u0275\u0275elementEnd())}function be(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,25),_.\u0275\u0275elementEnd())}function He(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,26),_.\u0275\u0275elementEnd())}function xe(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-option",7),_.\u0275\u0275text(1),_.\u0275\u0275elementEnd()),2&t){const e=r.$implicit;_.\u0275\u0275property("value",e),_.\u0275\u0275advance(1),_.\u0275\u0275textInterpolate(e)}}function Ke(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,27),_.\u0275\u0275elementEnd())}function Xe(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,28),_.\u0275\u0275elementEnd())}function ke(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"button",29),_.\u0275\u0275listener("click",function(){_.\u0275\u0275restoreView(e);const o=_.\u0275\u0275nextContext().index;return _.\u0275\u0275nextContext().remove(o)}),_.\u0275\u0275elementStart(1,"mat-icon"),_.\u0275\u0275text(2,"delete"),_.\u0275\u0275elementEnd()()}}const Je=function(t){return{"kd-deploy-form-progress-show":t}};function Ve(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"div",8)(1,"mat-form-field",9)(2,"input",10),_.\u0275\u0275listener("change",function(){const i=_.\u0275\u0275restoreView(e).index;return _.\u0275\u0275nextContext().checkPortMapping(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(3,Be,2,0,"mat-error",11),_.\u0275\u0275template(4,Ue,2,0,"mat-error",11),_.\u0275\u0275template(5,$e,2,0,"mat-error",11),_.\u0275\u0275template(6,ve,2,0,"mat-error",11),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(7,"p",12),_.\u0275\u0275elementStart(8,"mat-form-field",9)(9,"input",13),_.\u0275\u0275listener("change",function(){const i=_.\u0275\u0275restoreView(e).index;return _.\u0275\u0275nextContext().checkPortMapping(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(10,ye,2,0,"mat-error",11),_.\u0275\u0275template(11,Le,2,0,"mat-error",11),_.\u0275\u0275template(12,be,2,0,"mat-error",11),_.\u0275\u0275template(13,He,2,0,"mat-error",11),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(14,"p",12),_.\u0275\u0275elementStart(15,"mat-form-field",14)(16,"mat-select",15),_.\u0275\u0275template(17,xe,2,2,"mat-option",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(18,"mat-progress-bar",16),_.\u0275\u0275template(19,Ke,2,0,"mat-error",11),_.\u0275\u0275template(20,Xe,2,0,"mat-error",11),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(21,"div",17),_.\u0275\u0275template(22,ke,3,0,"button",18),_.\u0275\u0275elementEnd()()}if(2&t){const e=r.$implicit,n=r.index,o=_.\u0275\u0275nextContext();_.\u0275\u0275property("formGroupName",n),_.\u0275\u0275advance(2),_.\u0275\u0275property("required",o.isFirst(n)),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("port").errors?null:e.get("port").errors.kdValidInteger),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("port").errors?null:e.get("port").errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("port").errors?null:e.get("port").errors.min),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("port").errors?null:e.get("port").errors.max),_.\u0275\u0275advance(3),_.\u0275\u0275property("required",o.isFirst(n)),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("targetPort").errors?null:e.get("targetPort").errors.kdValidInteger),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("targetPort").errors?null:e.get("targetPort").errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("targetPort").errors?null:e.get("targetPort").errors.min),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("targetPort").errors?null:e.get("targetPort").errors.max),_.\u0275\u0275advance(3),_.\u0275\u0275property("isExternal",o.isExternal),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngForOf",o.protocols),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngClass",_.\u0275\u0275pureFunction1(17,Je,e.get("protocol").pending)),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("protocol").errors?null:e.get("protocol").errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("protocol").errors?null:e.get("protocol").errors.validProtocol),_.\u0275\u0275advance(2),_.\u0275\u0275property("ngIf",o.isRemovable(n))}}const q={label:"None",external:!1},we={label:"Internal",external:!1},ze={label:"External",external:!0};let qe=(()=>{class t{constructor(e,n){this.fb_=e,this.http_=n,this.changeExternal=new _.EventEmitter,this.propagateChange=o=>{}}ngOnInit(){this.serviceTypes=[q,we,ze],this.portMappingForm=this.fb_.group({serviceType:q,portMappings:this.fb_.array([])}),this.serviceType.valueChanges.subscribe(()=>{this.changeServiceType()}),this.portMappingForm.valueChanges.subscribe(e=>{this.propagateChange(e)})}validate(e){return this.portMappingForm.statusChanges.pipe((0,Ie.O)(this.portMappingForm.status),(0,De.h)(()=>!this.portMappingForm.pending),(0,$.q)(1),(0,v.U)(()=>this.portMappingForm.invalid?{error:!0}:null))}changeServiceType(){if(this.serviceType.value===q){const e=this.portMappings.length;for(let n=0;n<e;n++)this.portMappings.removeAt(0)}else 0===this.portMappings.length&&this.portMappings.push(this.newEmptyPortMapping(this.protocols[0]));this.isExternal=this.serviceType.value.external,this.changeExternal.emit(this.isExternal);for(let e=0;e<this.portMappings.length;e++){const n=this.portMappings.at(e).get("protocol");n.clearAsyncValidators(),n.setAsyncValidators(R_(this.http_,this.isExternal)),n.updateValueAndValidity()}}get portMappings(){return this.portMappingForm.get("portMappings")}get serviceType(){return this.portMappingForm.get("serviceType")}newEmptyPortMapping(e){return this.fb_.group({port:["",a.Validators.compose([u.isInteger,a.Validators.min(1),a.Validators.max(65535)])],targetPort:["",a.Validators.compose([u.isInteger,a.Validators.min(1),a.Validators.max(65535)])],protocol:[e]})}checkPortMapping(e){this.addProtocolIfNeeed(),this.validatePortMapping(e),this.portMappings.updateValueAndValidity()}addProtocolIfNeeed(){this.isPortMappingFilled(this.portMappings.controls[this.portMappings.length-1])&&this.portMappings.push(this.newEmptyPortMapping(this.protocols[0]))}isPortMappingFilled(e){return!!e.get("port").value&&!!e.get("targetPort").value}validatePortMapping(e){if(0===e)return;const n=this.portMappings.at(e),o=n.get("port"),i=n.get("targetPort"),E=o.value,R=i.value,S=this.isPortMappingFilledOrEmpty(E,R),c=S||!!R;o.setErrors(S||E?null:{required:!0}),i.setErrors(c?null:{required:!0}),this.portMappingForm.updateValueAndValidity()}isPortMappingFilledOrEmpty(e,n){return!e==!n}isRemovable(e){return e!==this.portMappings.length-1}remove(e){this.portMappings.removeAt(e)}isFirst(e){return 0===e}writeValue(){}registerOnChange(e){this.propagateChange=e}registerOnTouched(){}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(a.FormBuilder),_.\u0275\u0275directiveInject(p.eN))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-port-mappings"]],inputs:{protocols:"protocols",isExternal:"isExternal"},outputs:{changeExternal:"changeExternal"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,_.forwardRef)(()=>t),multi:!0},{provide:a.NG_ASYNC_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])],decls:8,vars:3,consts:function(){let r,e,n,o,i,E,R,S,m,c,O,g,F,f;return r="Service",e="\u7AEF\u53E3",n="\u76EE\u6A19\u7AEF\u53E3",o="\u5354\u8B70",i="\n            \u7AEF\u53E3\u865F\u5FC5\u9808\u662F\u6578\u5B57\n          ",E="\n            \u7AEF\u53E3\u865F\u4E0D\u80FD\u70BA\u7A7A\n          ",R="\n            \u7AEF\u53E3\u865F\u5FC5\u9808\u5927\u65BC 0\n          ",S="\n            \u7AEF\u53E3\u865F\u5FC5\u9808\u5C0F\u65BC 65536\n          ",m="\n            \u76EE\u6A19\u7AEF\u53E3\u5FC5\u9808\u662F\u6574\u6578\u3002\n          ",c="\n            \u76EE\u6A19\u7AEF\u53E3\u4E0D\u80FD\u7232\u7A7A\u3002\n          ",O="\n            \u76EE\u6A19\u7AEF\u53E3\u5FC5\u9808\u5927\u65BC 0\u3002\n          ",g="\n            \u76EE\u6A19\u7AEF\u53E3\u5FC5\u9808\u5C0F\u65BC 65536\u3002\n          ",F="\n            \u5354\u8B70\u662F\u5FC5\u9808\u7684\u3002\n          ",f="\n            \u7121\u6548\u7684\u5354\u8B70\u3002\n          ",[["fxLayout","column",3,"formGroup"],["fxLayout","row"],[1,"mat-block","kd-deploy-input-row",2,"width","100%"],["namespace","serviceType","formControlName","serviceType","placeholder",r,"required",""],[3,"value",4,"ngFor","ngForOf"],["formArrayName","portMappings"],["fxLayout","row",3,"formGroupName",4,"ngFor","ngForOf"],[3,"value"],["fxLayout","row",3,"formGroupName"],["md-no-float","","fxFlex","30",1,"kd-deploy-input-row","kd-port-form-field"],["matInput","","type","number","name","port","formControlName","port","placeholder",e,3,"required","change"],[4,"ngIf"],["fxFlex","5"],["matInput","","type","number","name","targetPort","formControlName","targetPort","placeholder",n,"min","1","max","65535",3,"required","change"],["md-no-float","","fxFlex","20",1,"kd-deploy-input-row","kd-port-form-field"],["name","protocol","formControlName","protocol","placeholder",o,"kdValidProtocol","","required","",3,"isExternal"],["mode","indeterminate",1,"kd-deploy-form-progress",3,"ngClass"],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],i,E,R,S,m,c,O,g,F,f,["mat-icon-button","",3,"click"]]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-select",3),_.\u0275\u0275template(4,he,2,2,"mat-option",4),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementContainerStart(5)(6,5),_.\u0275\u0275template(7,Ve,23,19,"div",6),_.\u0275\u0275elementContainerEnd()(),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275property("formGroup",n.portMappingForm),_.\u0275\u0275advance(4),_.\u0275\u0275property("ngForOf",n.serviceTypes),_.\u0275\u0275advance(3),_.\u0275\u0275property("ngForOf",n.portMappings.controls))},directives:[A.xw,a.NgControlStatusGroup,a.FormGroupDirective,d.KE,S_.gD,a.NgControlStatus,a.FormControlName,a.RequiredValidator,C.NgForOf,T_.ey,a.FormArrayName,a.FormGroupName,A.yH,D.Nt,a.NumberValueAccessor,a.DefaultValueAccessor,C.NgIf,d.TO,a.MinValidator,a.MaxValidator,Pe,E_.pW,C.NgClass,s_.oO,M.lW,w.Hw],styles:[".kd-port-form-field[_ngcontent-%COMP%]{margin:0 0 18px}"]}),t})();function Ye(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,14),_.\u0275\u0275elementEnd()),2&t){const e=_.\u0275\u0275nextContext().$implicit;_.\u0275\u0275advance(1),_.\u0275\u0275i18nExp(e.get("key").value),_.\u0275\u0275i18nApply(1)}}function je(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,15),_.\u0275\u0275elementEnd())}function We(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,16),_.\u0275\u0275elementEnd())}function Qe(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,17),_.\u0275\u0275elementEnd())}function Ze(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,18),_.\u0275\u0275elementEnd())}function _t(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,19),_.\u0275\u0275elementEnd())}function et(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,20),_.\u0275\u0275elementEnd())}function tt(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"button",21),_.\u0275\u0275listener("click",function(){_.\u0275\u0275restoreView(e);const o=_.\u0275\u0275nextContext().index;return _.\u0275\u0275nextContext().deleteLabel(o)}),_.\u0275\u0275elementStart(1,"mat-icon"),_.\u0275\u0275text(2,"delete"),_.\u0275\u0275elementEnd()()}}function nt(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"div",3)(1,"mat-form-field",4)(2,"input",5),_.\u0275\u0275listener("keyup",function(){const i=_.\u0275\u0275restoreView(e).index;return _.\u0275\u0275nextContext().check(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(3,Ye,2,1,"mat-error",6),_.\u0275\u0275template(4,je,2,0,"mat-error",6),_.\u0275\u0275template(5,We,2,0,"mat-error",6),_.\u0275\u0275template(6,Qe,2,0,"mat-error",6),_.\u0275\u0275template(7,Ze,2,0,"mat-error",6),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(8,"p",7),_.\u0275\u0275elementStart(9,"mat-form-field",8)(10,"input",9),_.\u0275\u0275listener("keyup",function(){const i=_.\u0275\u0275restoreView(e).index;return _.\u0275\u0275nextContext().check(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(11,"mat-hint",10),_.\u0275\u0275text(12),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(13,_t,2,0,"mat-error",6),_.\u0275\u0275template(14,et,2,0,"mat-error",6),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(15,"input",11),_.\u0275\u0275elementStart(16,"div",12),_.\u0275\u0275template(17,tt,3,0,"button",13),_.\u0275\u0275elementEnd()()}if(2&t){const e=r.$implicit,n=r.index,o=_.\u0275\u0275nextContext();_.\u0275\u0275property("formGroupName",n),_.\u0275\u0275advance(2),_.\u0275\u0275property("readonly",!e.get("editable").value),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("key").errors?null:e.get("key").errors.unique),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("key").errors?null:e.get("key").errors.kdValidLabelKeyPrefixPattern),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("key").errors?null:e.get("key").errors.kdValidLabelKeyNamePattern),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("key").errors?null:e.get("key").errors.kdValidLabelKeyPrefixLength),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("key").errors?null:e.get("key").errors.kdValidLabelKeyNameLength),_.\u0275\u0275advance(3),_.\u0275\u0275property("readonly",!e.get("editable").value),_.\u0275\u0275advance(2),_.\u0275\u0275textInterpolate1("",null==e.get("value").value?null:e.get("value").value.length," / 253"),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("value").errors?null:e.get("value").errors.kdValidLabelValuePattern),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==e.get("value").errors?null:e.get("value").errors.maxlength),_.\u0275\u0275advance(3),_.\u0275\u0275property("ngIf",o.isRemovable(n))}}let rt=(()=>{class t{constructor(e){this.fb_=e,this.propagateChange=n=>{}}ngOnInit(){this.labelForm=this.fb_.group({labels:this.fb_.array([])}),this.labelForm.valueChanges.subscribe(e=>{this.propagateChange(e)});for(let e=0;e<this.labelArr.length;e++)this.addNewLabel(this.labelArr[e].key,this.labelArr[e].value,this.labelArr[e].editable)}validate(e){return this.labelForm.valid?null:{labelValid:{value:this.labels.at(0).errors}}}get labels(){return this.labelForm.get("labels")}addNewLabel(e="",n="",o=!0){this.labels.push(this.fb_.group({key:[{value:e,disabled:!o},a.Validators.compose([u.labelKeyNameLength,u.labelKeyNamePattern,u.labelKeyPrefixLength,u.labelKeyPrefixPattern])],value:[{value:n,disabled:!o},a.Validators.compose([a.Validators.maxLength(253),u.labelValuePattern])],editable:o}))}check(e){this.addIfNeeded(),this.validateKey(e)}isRemovable(e){const n=this.labels.at(this.labels.length-1),o=this.labels.at(e),i=o.get("key").value,E=o.get("value").value,R=o.get("editable").value,S=n.get("key").value,m=n.get("value").value;return!(!R||i===S||E===m)}deleteLabel(e){this.labels.removeAt(e)}validateKey(e){const n=this.labels.at(e).get("key"),o=!this.isKeyDuplicated(e);n.setErrors(o?null:{unique:!0}),this.labelForm.updateValueAndValidity()}isKeyDuplicated(e){let n=0;const o=this.labels.at(e).get("key").value;for(let i=0;i<this.labels.length;i++){const E=this.labels.at(i).get("key").value;if(0!==E.length&&E===o&&n++,n>1)return!0}return!1}addIfNeeded(){const e=this.labels.at(this.labels.length-1);this.isFilled(e)&&this.addNewLabel()}isFilled(e){return 0!==e.get("key").value.length&&0!==e.get("value").value.length}writeValue(e){e.length>0&&this.labels.at(e[0].index).patchValue({value:e[0].value})}registerOnChange(e){this.propagateChange=e}registerOnTouched(){}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(a.FormBuilder))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-deploy-label"]],inputs:{labelArr:"labelArr"},features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,_.forwardRef)(()=>t),multi:!0},{provide:a.NG_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])],decls:3,vars:2,consts:function(){let r,e,n,o,i,E,R,S,m;return r="\u5BC6\u9470",e="\u503C",n="\n          " + "\ufffd0\ufffd" + " \u4E0D\u662F\u552F\u4E00\u7684\n        ",o="\n            \u524D\u7DB4\u4E0D\u662F\u6709\u6548\u7684\u524D\u7F00 DNS \u5B50\u57DF\u524D\u7F00\uFF08\u4F8B\u5982 my-domain.com \uFF09\u3002\n        ",i="\n            \u6A19\u7C64\u5BC6\u9470\u540D\u7A31\u5FC5\u9808\u662F\u7531 '-'\uFF0C'_' \u6216 '.' \u5206\u9694\u7684\u5B57\u6BCD\u6578\u5B57\uFF0C\u53EF\u9078\u4EE5 DNS \u5B50\u57DF\u548C '/' \u70BA\u524D\u7DB4\u3002\n        ",E="\n          \u524D\u7DB4\u4E0D\u61C9\u8D85\u904E 253 \u500B\u5B57\u7B26\u3002\n        ",R="\n          Label Key \u540D\u7A31\u4E0D\u61C9\u8D85\u904E 63 \u500B\u5B57\u7B26\n        ",S="\n            \u6A19\u7C64\u503C\u5FC5\u9808\u7531 '.' , '-' \u6216\u8005 '_' \u5206\u5272\u5B57\u6BCD\u6578\u5B57\n        ",m="\n            \u6A19\u7C64\u503C\u4E0D\u5F97\u8D85\u904E 253 \u500B\u5B57\u7B26\u3002\n        ",[[3,"formGroup"],["formArrayName","labels"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["md-no-float","","fxFlex","45",1,"kd-deploy-input-row"],["matInput","","name","key","formControlName","key","placeholder",r,3,"readonly","keyup"],[4,"ngIf"],["fxFlex","5"],["md-no-float","","fxFlex","40",1,"kd-deploy-input-row"],["matInput","","name","value","formControlName","value","placeholder",e,3,"readonly","keyup"],["align","end"],["type","hidden","formControlName","editable"],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],n,o,i,E,R,S,m,["mat-icon-button","",3,"click"]]},template:function(e,n){1&e&&(_.\u0275\u0275elementContainerStart(0,0),_.\u0275\u0275elementStart(1,"div",1),_.\u0275\u0275template(2,nt,18,12,"div",2),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementContainerEnd()),2&e&&(_.\u0275\u0275property("formGroup",n.labelForm),_.\u0275\u0275advance(2),_.\u0275\u0275property("ngForOf",n.labels.controls))},directives:[a.NgControlStatusGroup,a.FormGroupDirective,a.FormArrayName,C.NgForOf,a.FormGroupName,d.KE,A.yH,D.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlName,C.NgIf,d.TO,d.bx,M.lW,w.Hw],encapsulation:2}),t})();var ot=s(6709);function at(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,14),_.\u0275\u0275elementEnd())}function it(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"button",15),_.\u0275\u0275listener("click",function(){_.\u0275\u0275restoreView(e);const o=_.\u0275\u0275nextContext().index;return _.\u0275\u0275nextContext().remove(o)}),_.\u0275\u0275elementStart(1,"mat-icon"),_.\u0275\u0275text(2,"delete"),_.\u0275\u0275elementEnd()()}}function lt(t,r){if(1&t){const e=_.\u0275\u0275getCurrentView();_.\u0275\u0275elementStart(0,"div",6)(1,"mat-form-field",7)(2,"input",8),_.\u0275\u0275listener("change",function(){const i=_.\u0275\u0275restoreView(e).index;return _.\u0275\u0275nextContext().addVariableIfNeeed(i)}),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(3,at,2,0,"mat-error",9),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(4,"div",10),_.\u0275\u0275elementStart(5,"mat-form-field",7),_.\u0275\u0275element(6,"input",11),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(7,"div",12),_.\u0275\u0275template(8,it,3,0,"button",13),_.\u0275\u0275elementEnd()()}if(2&t){const e=r.$implicit,n=r.index,o=_.\u0275\u0275nextContext();_.\u0275\u0275property("formGroupName",n),_.\u0275\u0275advance(3),_.\u0275\u0275property("ngIf",null==e.get("name").errors?null:e.get("name").errors.pattern),_.\u0275\u0275advance(5),_.\u0275\u0275property("ngIf",o.isRemovable(n))}}let Et=(()=>{class t{constructor(e){this.fb_=e,this.namePattern=new RegExp("^[A-Za-z_][A-Za-z0-9_]*$"),this.propagateChange=n=>{}}ngOnInit(){this.form=this.fb_.group({variables:this.fb_.array([this.newVariable()])}),this.form.valueChanges.subscribe(e=>{this.propagateChange(e)})}validate(e){return this.form.valid?null:{labelValid:{value:this.form.errors}}}get variables(){return this.form.get("variables")}addVariableIfNeeed(){const e=this.variables.at(this.variables.length-1);this.isVariableFilled(e)&&e.valid&&this.variables.push(this.newVariable())}isVariableFilled(e){return!!e.get("name").value}newVariable(){return this.fb_.group({name:["",a.Validators.pattern(this.namePattern)],value:""})}isRemovable(e){return e!==this.variables.length-1}remove(e){this.variables.removeAt(e)}writeValue(){}registerOnChange(e){this.propagateChange=e}registerOnTouched(){}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(a.FormBuilder))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-environment-variables"]],features:[_.\u0275\u0275ProvidersFeature([{provide:a.NG_VALUE_ACCESSOR,useExisting:(0,_.forwardRef)(()=>t),multi:!0},{provide:a.NG_VALIDATORS,useExisting:(0,_.forwardRef)(()=>t),multi:!0}])],decls:6,vars:2,consts:function(){let r,e,n,o;return r="Environment variables",e="\u540D\u5B57",n="\u503C",o="\n            \u8B8A\u6578\u540D\u5FC5\u9808\u662F\u6709\u6548\u7684 C \u6A19\u8B58\u7B26\n          ",[["fxLayout","column"],[1,"kd-margin-bottom"],r,[3,"formGroup"],["formArrayName","variables"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["fxFlex","auto"],["matInput","","name","name","formControlName","name","placeholder",e,3,"change"],[4,"ngIf"],["fxFlex","5"],["matInput","","name","value","formControlName","value","placeholder",n],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],o,["mat-icon-button","",3,"click"]]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"div",0)(1,"div",1),_.\u0275\u0275i18n(2,2),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementContainerStart(3,3)(4,4),_.\u0275\u0275template(5,lt,9,3,"div",5),_.\u0275\u0275elementContainerEnd()(),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275advance(3),_.\u0275\u0275property("formGroup",n.form),_.\u0275\u0275advance(2),_.\u0275\u0275property("ngForOf",n.variables.controls))},directives:[A.xw,a.NgControlStatusGroup,a.FormGroupDirective,a.FormArrayName,C.NgForOf,a.FormGroupName,d.KE,A.yH,D.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlName,C.NgIf,d.TO,M.lW,w.Hw],encapsulation:2}),t})();function st(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,73),_.\u0275\u0275elementEnd())}function Rt(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,74),_.\u0275\u0275elementEnd())}function St(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,75),_.\u0275\u0275elementEnd())}function Tt(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,76),_.\u0275\u0275elementEnd())}function Nt(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,77),_.\u0275\u0275elementEnd()),2&t){const e=_.\u0275\u0275nextContext();_.\u0275\u0275advance(1),_.\u0275\u0275i18nExp(null==e.containerImage.errors?null:e.containerImage.errors.validImageReference),_.\u0275\u0275i18nApply(1)}}function mt(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,78),_.\u0275\u0275elementEnd())}function ct(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,79),_.\u0275\u0275elementEnd())}function Ot(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,80),_.\u0275\u0275elementEnd())}function dt(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-option",81),_.\u0275\u0275text(1),_.\u0275\u0275elementEnd()),2&t){const e=r.$implicit;_.\u0275\u0275property("value",e),_.\u0275\u0275advance(1),_.\u0275\u0275textInterpolate1(" ",e," ")}}function Ct(t,r){if(1&t&&(_.\u0275\u0275elementStart(0,"mat-option",81),_.\u0275\u0275text(1),_.\u0275\u0275elementEnd()),2&t){const e=r.$implicit;_.\u0275\u0275property("value",e),_.\u0275\u0275advance(1),_.\u0275\u0275textInterpolate1(" ",e," ")}}function ut(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,82),_.\u0275\u0275elementEnd())}function pt(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,83),_.\u0275\u0275elementEnd())}function Mt(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,84),_.\u0275\u0275elementEnd())}function At(t,r){1&t&&(_.\u0275\u0275elementStart(0,"mat-error"),_.\u0275\u0275i18n(1,85),_.\u0275\u0275elementEnd())}const gt=function(t){return{"kd-deploy-form-progress-show":t}};let N_=(()=>{class t extends U{constructor(e,n,o,i,E,R,S,m){super(),this.namespace_=e,this.create_=n,this.history_=o,this.http_=i,this.route_=E,this.fb_=R,this.dialog_=S,this.router_=m,this.showMoreOptions_=!1,this.isExternal=!1,this.labelArr=[],this.nameMaxLength=24,this.created_=!1,this.unsubscribe_=new n_.x}get name(){return this.form.get("name")}get containerImage(){return this.form.get("containerImage")}get replicas(){return this.form.get("replicas")}get description(){return this.form.get("description")}get namespace(){return this.form.get("namespace")}get imagePullSecret(){return this.form.get("imagePullSecret")}get cpuRequirement(){return this.form.get("cpuRequirement")}get memoryRequirement(){return this.form.get("memoryRequirement")}get containerCommand(){return this.form.get("containerCommand")}get containerCommandArgs(){return this.form.get("containerCommandArgs")}get runAsPrivileged(){return this.form.get("runAsPrivileged")}get portMappings(){return this.form.get("portMappings")}get variables(){return this.form.get("variables")}get labels(){return this.form.get("labels")}ngOnInit(){this.form=this.fb_.group({name:["",a.Validators.compose([a.Validators.required,u.namePattern])],containerImage:["",a.Validators.required],replicas:[1,a.Validators.compose([a.Validators.required,u.isInteger])],description:[""],namespace:[this.route_.snapshot.params.namespace||"",a.Validators.required],imagePullSecret:[""],cpuRequirement:["",a.Validators.compose([a.Validators.min(0),u.isInteger])],memoryRequirement:["",a.Validators.compose([a.Validators.min(0),u.isInteger])],containerCommand:[""],containerCommandArgs:[""],runAsPrivileged:[!1],portMappings:this.fb_.control([]),variables:this.fb_.control([]),labels:this.fb_.control([])}),this.labelArr=[new i_("k8s-app","",!1),new i_],this.name.valueChanges.subscribe(e=>{this.labelArr[0].value=e,this.labels.patchValue([{index:0,value:e}])}),this.namespace.valueChanges.pipe((0,r_.R)(this.unsubscribe_)).subscribe(e=>{this.name.clearAsyncValidators(),this.name.setAsyncValidators(l_(this.http_,e)),this.name.updateValueAndValidity()}),this.http_.get("api/v1/namespace").subscribe(e=>{this.namespaces=e.namespaces.map(n=>n.objectMeta.name),this.namespace.patchValue(this.namespace_.areMultipleNamespacesSelected()?this.namespaces[0]:this.route_.snapshot.params.namespace||this.namespaces[0]),this.form.markAsPristine()}),this.http_.get("api/v1/appdeployment/protocols").subscribe(e=>this.protocols=e.protocols)}ngOnDestroy(){this.unsubscribe_.next(),this.unsubscribe_.complete()}changeExternal(e){this.isExternal=e}resetImagePullSecret(){this.imagePullSecret.patchValue("")}hasUnsavedChanges(){return this.form.dirty}isCreateDisabled(){return!this.form.valid||this.create_.isDeployDisabled()}getSecrets(){this.http_.get(`api/v1/secret/${this.namespace.value}`).subscribe(e=>{this.secrets=e.secrets.map(n=>n.objectMeta.name)})}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}isMoreOptionsEnabled(){return this.showMoreOptions_}switchMoreOptions(){this.showMoreOptions_=!this.showMoreOptions_}handleNamespaceDialog(){this.dialog_.open(me,{data:{namespaces:this.namespaces}}).afterClosed().pipe((0,$.q)(1)).subscribe(o=>{o?(this.namespaces.push(o),this.namespace.patchValue(o)):this.namespace.patchValue(this.namespaces[0])})}handleCreateSecretDialog(){this.dialog_.open(Ae,{data:{namespace:this.namespace.value}}).afterClosed().pipe((0,$.q)(1)).subscribe(o=>{o?(this.secrets.push(o),this.imagePullSecret.patchValue(o)):this.imagePullSecret.patchValue("")})}isPortMappingFilled(e){return!!e.port&&!!e.targetPort}isVariableFilled(e){return!!e.name}isNumber(e){return"number"==typeof e&&!isNaN(e)}toBackendApiLabels(e){return e[0].key=this.labelArr[0].key,e[0].value=this.labelArr[0].value,e.filter(n=>0!==n.key.length&&0!==n.value.length)}preview(){this.dialog_.open(Ee,{width:"900px",data:{spec:this.getSpec()}})}deploy(){const e=this.getSpec();this.create_.deploy(e).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[K.x]:e.namespace}})})}getSpec(){const n=this.variables.value.variables||[],o=this.labels.value.labels||[];return{containerImage:this.containerImage.value,imagePullSecret:this.imagePullSecret.value?this.imagePullSecret.value:null,containerCommand:this.containerCommand.value?this.containerCommand.value:null,containerCommandArgs:this.containerCommandArgs.value?this.containerCommandArgs.value:null,isExternal:this.isExternal,name:this.name.value,description:this.description.value?this.description.value:null,portMappings:(this.portMappings.value.portMappings||[]).filter(this.isPortMappingFilled),variables:n.filter(this.isVariableFilled),replicas:this.replicas.value,namespace:this.namespace.value,cpuRequirement:this.isNumber(this.cpuRequirement.value)?this.cpuRequirement.value:null,memoryRequirement:this.isNumber(this.memoryRequirement.value)?`${this.memoryRequirement.value}Mi`:null,labels:this.toBackendApiLabels(o),runAsPrivileged:this.runAsPrivileged.value}}canDeactivate(){return this.form.pristine||this.created_}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(P.L),_.\u0275\u0275directiveInject(h),_.\u0275\u0275directiveInject(X.q),_.\u0275\u0275directiveInject(p.eN),_.\u0275\u0275directiveInject(I.ActivatedRoute),_.\u0275\u0275directiveInject(a.FormBuilder),_.\u0275\u0275directiveInject(N.uw),_.\u0275\u0275directiveInject(I.Router))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create-from-form"]],features:[_.\u0275\u0275InheritDefinitionFeature],decls:144,vars:30,consts:function(){let r,e,n,o,i,E,R,S,m,c,O,g,F,f,T,O_,d_,C_,u_,p_,M_,A_,g_,F_,f_,I_,D_,G_,P_,h_,B_,U_,$_,v_,y_,L_,b_,H_,x_,K_,y,X_,k_,J_,V_,w_,z_,q_,Y_,j_,W_,Q_,Z_,_e;return r="\u61C9\u7528\u540D\u7A31",e="\u5177\u6709\u6B64\u503C\u7684 'app' \u6A19\u7C64\u5C07\u6DFB\u52A0\u5230\u5DF2\u90E8\u7F72\u7684 Deployment \u548C Service \u4E2D\u3002",n="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#15\ufffd" + "open_in_new" + "\ufffd/#15\ufffd" + "\n            ",o="\u5BB9\u5668\u6620\u50CF\u6A94",i="\u8F38\u5165\u516C\u958B\u5009\u5EAB\u6216\u662F\u79C1\u6709\u5009\u5EAB (Docker Hub \u6216 Google Container Registry) \u7684 URL\u3002",E="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#26\ufffd" + "open_in_new" + "\ufffd/#26\ufffd" + "\n            ",R="pod \u7684\u6578\u91CF",S="Deployment \u5C07\u88AB\u5275\u5EFA\u4F86\u7BA1\u7406\u4E00\u5B9A\u6578\u91CF\u7684 pod \u5728\u60A8\u7684\u53E2\u96C6\u4E2D\u3002",m="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#38\ufffd" + "open_in_new" + "\ufffd/#38\ufffd" + "\n            ",c="(\u53EF\u9078\u64C7\u7684) \u53EF\u4EE5\u5B9A\u7FA9\u5185\u90E8\u6216\u5916\u90E8 Service\uFF0C\u5C07\u50B3\u5165\u7AEF\u53E3\u6620\u5C04\u5230\u5BB9\u5668\u7684\u76EE\u6A19\u7AEF\u53E3\u3002",O="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#47\ufffd" + "open_in_new" + "\ufffd/#47\ufffd" + "\n            ",g="\u547D\u540D\u7A7A\u9593",F="\n            \u5275\u5EFA\u4E00\u4E2A\u65B0\u7684\u547D\u540D\u7A7A\u9593...\n          ",f="\u547D\u540D\u7A7A\u9593\u5141\u8A31\u60A8\u5C07\u8CC7\u6E90\u5206\u5340\u70BA\u908F\u8F2F\u547D\u540D\u7684\u7D44\u3002",T="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#59\ufffd" + "open_in_new" + "\ufffd/#59\ufffd" + "\n            ",O_="\u63CF\u8FF0",d_="\n            \u8A72\u63CF\u8FF0\u5C07\u4F5C\u70BA\u6CE8\u8996\u6DFB\u52A0\u5230 Deployment \u4E2D\uFF0C\u4E26\u986F\u793A\u5728\u61C9\u7528\u7A0B\u5F0F\u7684\u8A73\u7D30\u8CC7\u8A0A\u4E2D\u3002\n      ",C_="\u6A19\u7C64",u_="\u6307\u5B9A\u7684\u6A19\u7C64\u5C07\u7528\u65BC\u5275\u5EFA\u7684 Deployment\uFF0CService\uFF08\u5982\u679C\u6709\uFF09\u548C Pod\u3002 \u5E38\u898B\u6A19\u7C64\u5305\u62EC release\uFF0Cenvironment\uFF0Ctier\uFF0Cpartition \u548C track\u3002",p_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#76\ufffd" + "open_in_new" + "\ufffd/#76\ufffd" + "\n            ",M_="\u53D6\u5F97\u6620\u50CF\u6A94\u4F7F\u7528\u7684 Secret",A_="\n           \u5275\u5EFA\u4E00\u500B\u65B0\u7684 secret...\n          ",g_="\u5982\u679C\u6307\u5B9A\u7684\u6620\u50CF\u6A94\u662F\u79C1\u6709\u7684\uFF0C\u5247\u53EF\u80FD\u9700\u8981 pull secret credential\u3002 \u60A8\u53EF\u4EE5\u9078\u64C7\u73FE\u6709 secret \u6216\u5275\u5EFA\u65B0 secret\u3002",F_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#88\ufffd" + "open_in_new" + "\ufffd/#88\ufffd" + "\n            ",f_="CPU \u4E0B\u9650 (cores)",I_="Memory \u4E0B\u9650 (MiB)",D_="\u60A8\u53EF\u4EE5\u6307\u5B9A\u5BB9\u5668\u7684\u6700\u4F4E CPU \u548C\u8A18\u61B6\u9AD4\u9700\u6C42\u3002",G_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#105\ufffd" + "open_in_new" + "\ufffd/#105\ufffd" + "\n            ",P_="\u57F7\u884C\u547D\u4EE4",h_="\u57F7\u884C\u547D\u4EE4\u53C3\u6578",B_="\u9ED8\u8A8D\u60C5\u51B5\u4E0B\uFF0C\u5BB9\u5668\u904B\u884C\u6240\u9078\u6620\u50CF\u6A94\u7684\u9ED8\u8A8D entrypoint \u547D\u4EE4\u3002\u60A8\u53EF\u4EE5\u4F7F\u7528\u547D\u4EE4\u9078\u9805\u8986\u84CB\u9ED8\u8A8D\u503C\u3002",U_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#117\ufffd" + "open_in_new" + "\ufffd/#117\ufffd" + "\n            ",$_="\u4EE5\u7279\u6B0A\u8EAB\u4EFD\u904B\u884C",v_="\u7279\u6B0A\u5BB9\u5668\u4E2D\u7684\u7A0B\u5E8F\u7B49\u540C\u65BC\u5728\u4E3B\u6A5F\u4E0A\u4EE5 root \u8EAB\u4EFD\u57F7\u884C\u7684\u7A0B\u5E8F\u3002",y_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#127\ufffd" + "open_in_new" + "\ufffd/#127\ufffd" + "\n            ",L_="\u53EF\u5728\u5BB9\u5668\u4E2D\u4F7F\u7528\u7684\u74B0\u5883\u8B8A\u6578\u3002\u503C\u53EF\u4EE5\u4F7F\u7528 $(VAR_NAME) \u8A9E\u6CD5\u5F15\u7528\u5176\u4ED6\u8B8A\u6578",b_="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#135\ufffd" + "open_in_new" + "\ufffd/#135\ufffd" + "\n            ",H_="\n  \u90E8\u7F72\n",x_=" Preview\n",K_="Cancel",y="{VAR_SELECT, select, true {\u96B1\u85CF\u9AD8\u7D1A\u8A2D\u7F6E} other {\u986F\u793A\u9AD8\u7D1A\u9078\u9805}}",y=_.\u0275\u0275i18nPostprocess(y,{VAR_SELECT:"\ufffd0\ufffd"}),X_="\n  " + y + "\n",k_="\n        \u5177\u6709\u540C\u540D\u7A31\u7684 deployment \u6216 service \u5DF2\u5B58\u5728\u65BC\u547D\u540D\u7A7A\u9593\u4E2D\n      ",J_="\n        \u61C9\u7528\u540D\u7A31\u662F\u5FC5\u9700\u7684\u3002\n      ",V_="\n        \u61C9\u7528\u540D\u7A31\u5FC5\u9808\u4EE5\u5C0F\u5BEB\u5B57\u6BCD\u958B\u982D\uFF0C\u53EA\u5305\u542B\u5C0F\u5BEB\u5B57\u6BCD\u8207\u6578\u5B57\uFF0C\u4E26\u4E14\u4E4B\u9593\u53EF\u4EE5\u5305\u542B '-' \u7B26\u865F\u3002\n      ",w_="\n        \u5BB9\u5668\u93E1\u50CF\u662F\u5FC5\u9808\u7684\n      ",z_="\n        \u5BB9\u5668\u6620\u50CF\u6A94\u7121\u6548: " + "\ufffd0\ufffd" + "\n      ",q_="\n        pod \u7684\u6578\u91CF\u662F\u5FC5\u586B\u9805\n      ",Y_="\n        pod \u7684\u6578\u91CF\u5FC5\u9808\u662F\u6B63\u6574\u6578\n      ",j_="\n        \u8A2D\u5B9A\u5927\u91CF pod \u53EF\u80FD\u6703\u5C0E\u81F4\u53E2\u96C6\u548C Dashboard UI \u51FA\u73FE\u6548\u80FD\u554F\u984C\u3002\n      ",W_="\n            CPU \u4E0B\u9650\u5FC5\u9808\u662F\u6B63\u6574\u6578\u3002\n          ",Q_="\n            CPU \u4E0B\u9650\u5FC5\u9808\u662F\u6709\u6548\u7684\u6578\u5B57\u3002\n          ",Z_="\n            Memory \u4E0B\u9650\u5FC5\u9808\u662F\u6B63\u6574\u6578\u3002\n          ",_e="\n            Memory \u4E0B\u9650\u5FC5\u9808\u662F\u4E00\u500B\u6709\u6548\u7684\u6578\u5B57\u3002\n          ",[["novalidate","",3,"formGroup"],["matInput","","formControlName","name","placeholder",r,"kdUniqueName","","required","",3,"maxlength","namespace"],["mode","indeterminate",1,"kd-deploy-form-progress",3,"ngClass"],["align","end"],[4,"ngIf"],e,["href","https://kubernetes.io/docs/user-guide/labels/","target","_blank","tabindex","-1"],n,[1,"material-icons"],["matInput","","formControlName","containerImage","placeholder",o,"kdValidImageReference","","required",""],i,["href","https://kubernetes.io/docs/user-guide/images/","target","_blank","tabindex","-1"],E,["matInput","","type","number","formControlName","replicas","placeholder",R,"min","1","kdWarnThreshold","100","required",""],S,["href","https://kubernetes.io/docs/concepts/workloads/controllers/deployment/","target","_blank","tabindex","-1"],m,["fxLayout","column"],["formControlName","portMappings",3,"protocols","isExternal","changeExternal"],c,["href","https://kubernetes.io/docs/user-guide/services/","target","_blank","tabindex","-1"],O,["formControlName","namespace","placeholder",g,"required","",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],F,f,["href","https://kubernetes.io/docs/admin/namespaces/","target","_blank","tabindex","-1"],T,[3,"hidden"],["formControlName","description","matInput","","placeholder",O_],d_,[1,"kd-margin-bottom"],C_,["formControlName","labels",3,"labelArr"],u_,p_,["formControlName","imagePullSecret","placeholder",M_,3,"click"],A_,g_,["href","https://kubernetes.io/docs/user-guide/secrets/","target","_blank","tabindex","-1"],F_,["fxLayout","row"],["fxFlex","auto"],["matInput","","type","number","placeholder",f_,"name","cpuRequirement","min","0","formControlName","cpuRequirement"],["fxFlex","5"],["matInput","","type","number","placeholder",I_,"name","memoryRequirement","min","0","formControlName","memoryRequirement"],D_,["href","https://kubernetes.io/docs/admin/limitrange/","target","_blank","tabindex","-1"],G_,[1,"kd-block"],["matInput","","placeholder",P_,"formControlName","containerCommand"],["matInput","","placeholder",h_,"formControlName","containerCommandArgs"],B_,["href","https://kubernetes.io/docs/user-guide/containers/","target","_blank","tabindex","-1"],U_,["color","primary","formControlName","runAsPrivileged"],$_,v_,["href","https://kubernetes.io/docs/concepts/workloads/pods/#privileged-mode-for-containers","target","_blank","tabindex","-1"],y_,["formControlName","variables"],L_,["href","https://kubernetes.io/docs/tasks/inject-data-application/define-environment-variable-container/","target","_blank","tabindex","-1"],b_,["type","button","color","primary","mat-raised-button","",3,"disabled","click"],H_,["type","button","color","primary","mat-button","",3,"disabled","click"],x_,["type","button","color","primary","mat-button","",3,"click"],K_,["mat-button","","color","primary",3,"hidden","click"],X_,k_,J_,V_,w_,z_,q_,Y_,j_,[3,"value"],W_,Q_,Z_,_e]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"form",0)(1,"kd-help-section")(2,"mat-form-field"),_.\u0275\u0275element(3,"input",1)(4,"mat-progress-bar",2),_.\u0275\u0275elementStart(5,"mat-hint",3),_.\u0275\u0275text(6),_.\u0275\u0275elementEnd(),_.\u0275\u0275template(7,st,2,0,"mat-error",4),_.\u0275\u0275template(8,Rt,2,0,"mat-error",4),_.\u0275\u0275template(9,St,2,0,"mat-error",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(10,"kd-user-help"),_.\u0275\u0275elementContainerStart(11),_.\u0275\u0275i18n(12,5),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(13,"a",6),_.\u0275\u0275i18nStart(14,7),_.\u0275\u0275element(15,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(16,"kd-help-section")(17,"mat-form-field"),_.\u0275\u0275element(18,"input",9),_.\u0275\u0275template(19,Tt,2,0,"mat-error",4),_.\u0275\u0275template(20,Nt,2,1,"mat-error",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(21,"kd-user-help"),_.\u0275\u0275elementContainerStart(22),_.\u0275\u0275i18n(23,10),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(24,"a",11),_.\u0275\u0275i18nStart(25,12),_.\u0275\u0275element(26,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(27,"kd-help-section")(28,"mat-form-field"),_.\u0275\u0275element(29,"input",13),_.\u0275\u0275template(30,mt,2,0,"mat-error",4),_.\u0275\u0275template(31,ct,2,0,"mat-error",4),_.\u0275\u0275template(32,Ot,2,0,"mat-error",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(33,"kd-user-help"),_.\u0275\u0275elementContainerStart(34),_.\u0275\u0275i18n(35,14),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(36,"a",15),_.\u0275\u0275i18nStart(37,16),_.\u0275\u0275element(38,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(39,"kd-help-section")(40,"div",17)(41,"kd-port-mappings",18),_.\u0275\u0275listener("changeExternal",function(i){return n.changeExternal(i)}),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(42,"kd-user-help"),_.\u0275\u0275elementContainerStart(43),_.\u0275\u0275i18n(44,19),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(45,"a",20),_.\u0275\u0275i18nStart(46,21),_.\u0275\u0275element(47,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(48,"kd-help-section")(49,"mat-form-field")(50,"mat-select",22),_.\u0275\u0275listener("click",function(){return n.resetImagePullSecret()}),_.\u0275\u0275template(51,dt,2,2,"mat-option",23),_.\u0275\u0275elementStart(52,"mat-option",24),_.\u0275\u0275listener("click",function(){return n.handleNamespaceDialog()}),_.\u0275\u0275i18n(53,25),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(54,"kd-user-help"),_.\u0275\u0275elementContainerStart(55),_.\u0275\u0275i18n(56,26),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(57,"a",27),_.\u0275\u0275i18nStart(58,28),_.\u0275\u0275element(59,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(60,"div",29)(61,"kd-help-section")(62,"mat-form-field"),_.\u0275\u0275element(63,"textarea",30),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(64,"kd-user-help"),_.\u0275\u0275i18n(65,31),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(66,"kd-help-section")(67,"div",17)(68,"div",32),_.\u0275\u0275i18n(69,33),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(70,"kd-deploy-label",34),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(71,"kd-user-help"),_.\u0275\u0275elementContainerStart(72),_.\u0275\u0275i18n(73,35),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(74,"a",6),_.\u0275\u0275i18nStart(75,36),_.\u0275\u0275element(76,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(77,"kd-help-section")(78,"mat-form-field")(79,"mat-select",37),_.\u0275\u0275listener("click",function(){return n.getSecrets()}),_.\u0275\u0275template(80,Ct,2,2,"mat-option",23),_.\u0275\u0275elementStart(81,"mat-option",24),_.\u0275\u0275listener("click",function(){return n.handleCreateSecretDialog()}),_.\u0275\u0275i18n(82,38),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(83,"kd-user-help"),_.\u0275\u0275elementContainerStart(84),_.\u0275\u0275i18n(85,39),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(86,"a",40),_.\u0275\u0275i18nStart(87,41),_.\u0275\u0275element(88,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(89,"kd-help-section")(90,"div",42)(91,"mat-form-field",43),_.\u0275\u0275element(92,"input",44),_.\u0275\u0275template(93,ut,2,0,"mat-error",4),_.\u0275\u0275template(94,pt,2,0,"mat-error",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275element(95,"div",45),_.\u0275\u0275elementStart(96,"mat-form-field",43),_.\u0275\u0275element(97,"input",46),_.\u0275\u0275template(98,Mt,2,0,"mat-error",4),_.\u0275\u0275template(99,At,2,0,"mat-error",4),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(100,"kd-user-help"),_.\u0275\u0275elementContainerStart(101),_.\u0275\u0275i18n(102,47),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(103,"a",48),_.\u0275\u0275i18nStart(104,49),_.\u0275\u0275element(105,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(106,"kd-help-section")(107,"div")(108,"mat-form-field",50),_.\u0275\u0275element(109,"input",51),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(110,"mat-form-field",50),_.\u0275\u0275element(111,"input",52),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(112,"kd-user-help"),_.\u0275\u0275elementContainerStart(113),_.\u0275\u0275i18n(114,53),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(115,"a",54),_.\u0275\u0275i18nStart(116,55),_.\u0275\u0275element(117,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(118,"kd-help-section")(119,"div",50)(120,"mat-checkbox",56),_.\u0275\u0275i18n(121,57),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(122,"kd-user-help"),_.\u0275\u0275elementContainerStart(123),_.\u0275\u0275i18n(124,58),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(125,"a",59),_.\u0275\u0275i18nStart(126,60),_.\u0275\u0275element(127,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()(),_.\u0275\u0275elementStart(128,"kd-help-section"),_.\u0275\u0275element(129,"kd-environment-variables",61),_.\u0275\u0275elementStart(130,"kd-user-help"),_.\u0275\u0275elementContainerStart(131),_.\u0275\u0275i18n(132,62),_.\u0275\u0275elementContainerEnd(),_.\u0275\u0275elementStart(133,"a",63),_.\u0275\u0275i18nStart(134,64),_.\u0275\u0275element(135,"i",8),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()()()()(),_.\u0275\u0275elementStart(136,"button",65),_.\u0275\u0275listener("click",function(){return n.deploy()}),_.\u0275\u0275i18n(137,66),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(138,"button",67),_.\u0275\u0275listener("click",function(){return n.preview()}),_.\u0275\u0275i18n(139,68),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(140,"button",69),_.\u0275\u0275listener("click",function(){return n.cancel()}),_.\u0275\u0275i18n(141,70),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(142,"button",71),_.\u0275\u0275listener("click",function(){return n.switchMoreOptions()}),_.\u0275\u0275i18n(143,72),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275property("formGroup",n.form),_.\u0275\u0275advance(3),_.\u0275\u0275property("maxlength",n.nameMaxLength)("namespace",n.namespace.value),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngClass",_.\u0275\u0275pureFunction1(28,gt,n.name.pending)),_.\u0275\u0275advance(2),_.\u0275\u0275textInterpolate2("",null==n.name.value?null:n.name.value.length," / ",n.nameMaxLength,""),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.name.errors?null:n.name.errors.uniqueName),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.name.errors?null:n.name.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.name.errors?null:n.name.errors.namePattern),_.\u0275\u0275advance(10),_.\u0275\u0275property("ngIf",null==n.containerImage.errors?null:n.containerImage.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.containerImage.errors?null:n.containerImage.errors.validImageReference),_.\u0275\u0275advance(10),_.\u0275\u0275property("ngIf",null==n.replicas.errors?null:n.replicas.errors.required),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.replicas.errors?null:n.replicas.errors.kdValidInteger),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.replicas.errors?null:n.replicas.errors.warnThreshold),_.\u0275\u0275advance(9),_.\u0275\u0275property("protocols",n.protocols)("isExternal",n.isExternal),_.\u0275\u0275advance(10),_.\u0275\u0275property("ngForOf",n.namespaces),_.\u0275\u0275advance(9),_.\u0275\u0275property("hidden",!n.isMoreOptionsEnabled()),_.\u0275\u0275advance(10),_.\u0275\u0275property("labelArr",n.labelArr),_.\u0275\u0275advance(10),_.\u0275\u0275property("ngForOf",n.secrets),_.\u0275\u0275advance(13),_.\u0275\u0275property("ngIf",null==n.cpuRequirement.errors?null:n.cpuRequirement.errors.min),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.cpuRequirement.errors?null:n.cpuRequirement.errors.kdValidInteger),_.\u0275\u0275advance(4),_.\u0275\u0275property("ngIf",null==n.memoryRequirement.errors?null:n.memoryRequirement.errors.min),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",null==n.memoryRequirement.errors?null:n.memoryRequirement.errors.kdValidInteger),_.\u0275\u0275advance(37),_.\u0275\u0275property("disabled",n.isCreateDisabled()),_.\u0275\u0275advance(2),_.\u0275\u0275property("disabled",n.isCreateDisabled()),_.\u0275\u0275advance(4),_.\u0275\u0275property("hidden",!n.isMoreOptionsEnabled()),_.\u0275\u0275advance(1),_.\u0275\u0275i18nExp(n.isMoreOptionsEnabled()),_.\u0275\u0275i18nApply(143))},directives:[a.\u0275NgNoValidate,a.NgControlStatusGroup,a.FormGroupDirective,k,d.KE,D.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlName,Oe,a.RequiredValidator,a.MaxLengthValidator,E_.pW,C.NgClass,s_.oO,d.bx,C.NgIf,d.TO,J,Fe,a.NumberValueAccessor,a.MinValidator,fe,A.xw,qe,S_.gD,C.NgForOf,T_.ey,rt,A.yH,ot.oG,Et,M.lW],styles:[".kd-block[_ngcontent-%COMP%]{display:block}.kd-deploy-input-row[_ngcontent-%COMP%]{margin-bottom:8px;margin-top:8px}  mat-progress-bar.kd-deploy-form-progress{clear:left;height:.5px;margin-bottom:-.5px;overflow:hidden;top:5px}  mat-progress-bar.kd-deploy-form-progress:not(.kd-deploy-form-progress-show){visibility:hidden}"]}),t})();function ft(t,r){1&t&&(_.\u0275\u0275elementStart(0,"span"),_.\u0275\u0275i18n(1,10),_.\u0275\u0275elementEnd())}function It(t,r){1&t&&(_.\u0275\u0275elementStart(0,"span"),_.\u0275\u0275i18n(1,11),_.\u0275\u0275elementEnd())}let m_=(()=>{class t extends U{constructor(e,n,o,i){super(),this.namespace_=e,this.create_=n,this.history_=o,this.router_=i,this.inputData="",this.created_=!1}isCreateDisabled(){return!this.inputData||0===this.inputData.length}create(){this.create_.createContent(this.inputData).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[K.x]:this.namespace_.current()}})})}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}canDeactivate(){return this.isCreateDisabled()||this.created_}}return t.\u0275fac=function(e){return new(e||t)(_.\u0275\u0275directiveInject(P.L),_.\u0275\u0275directiveInject(h),_.\u0275\u0275directiveInject(X.q),_.\u0275\u0275directiveInject(I.Router))},t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create-from-input"]],features:[_.\u0275\u0275InheritDefinitionFeature],decls:11,vars:4,consts:function(){let r,e,n,o,i;return r="\n              \u5B78\u5230\u66F4\u591A\n              " + "\ufffd#5\ufffd" + "open_in_new" + "\ufffd/#5\ufffd" + "\n            ",e="\n            \u4E0A\u50B3\n",n="Cancel",o="\n    \u8F38\u5165 YAML \u6216 JSON \u5185\u5BB9\uFF0C\u6307\u5B9A\u8981\u70BA\u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u9593\u5275\u5EFA\u7684\u8CC7\u6E90\u3002\n  ",i="\n    \u8F38\u5165 YAML \u6216 JSON \u5185\u5BB9\uFF0C\u6307\u5B9A\u8981\u7232\u7576\u524D\u9078\u5B9A\u7684\u547D\u540D\u7A7A\u9593\u5275\u5EFA\u7684\u8CC7\u6E90\u3002\n  ",[[1,"kd-create-from-input-info"],[4,"ngIf"],["href","https://kubernetes.io/docs/tasks/run-application/run-stateless-application-deployment/","target","_blank"],r,[1,"material-icons"],[3,"text","textChange"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],e,["type","button","color","primary","mat-button","",3,"click"],n,o,i]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"div",0),_.\u0275\u0275template(1,ft,2,0,"span",1),_.\u0275\u0275template(2,It,2,0,"span",1),_.\u0275\u0275elementStart(3,"a",2),_.\u0275\u0275i18nStart(4,3),_.\u0275\u0275element(5,"i",4),_.\u0275\u0275i18nEnd(),_.\u0275\u0275elementEnd()(),_.\u0275\u0275elementStart(6,"kd-text-input",5),_.\u0275\u0275listener("textChange",function(i){return n.inputData=i}),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(7,"button",6),_.\u0275\u0275listener("click",function(){return n.create()}),_.\u0275\u0275i18n(8,7),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(9,"button",8),_.\u0275\u0275listener("click",function(){return n.cancel()}),_.\u0275\u0275i18n(10,9),_.\u0275\u0275elementEnd()),2&e&&(_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",n.areMultipleNamespacesSelected()),_.\u0275\u0275advance(1),_.\u0275\u0275property("ngIf",!n.areMultipleNamespacesSelected()),_.\u0275\u0275advance(4),_.\u0275\u0275property("text",n.inputData),_.\u0275\u0275advance(1),_.\u0275\u0275property("disabled",n.isCreateDisabled()))},directives:[C.NgIf,G.t,M.lW],styles:[".kd-create-from-input-info[_ngcontent-%COMP%]{margin-bottom:24px;padding:0 4px}.kd-create-from-input-info[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.kd-create-from-input-button[_ngcontent-%COMP%]{margin-left:0}  .kd-ace{margin-bottom:24px}"]}),t})();var Dt=s(3546),c_=s(3848);const Gt={path:"",component:(()=>{class t extends U{canDeactivate(){return this.fromInput.canDeactivate()&&this.fromFile.canDeactivate()&&this.fromForm.canDeactivate()}}return t.\u0275fac=function(){let r;return function(n){return(r||(r=_.\u0275\u0275getInheritedFactory(t)))(n||t)}}(),t.\u0275cmp=_.\u0275\u0275defineComponent({type:t,selectors:[["kd-create"]],viewQuery:function(e,n){if(1&e&&(_.\u0275\u0275viewQuery(m_,5),_.\u0275\u0275viewQuery(e_,5),_.\u0275\u0275viewQuery(N_,5)),2&e){let o;_.\u0275\u0275queryRefresh(o=_.\u0275\u0275loadQuery())&&(n.fromInput=o.first),_.\u0275\u0275queryRefresh(o=_.\u0275\u0275loadQuery())&&(n.fromFile=o.first),_.\u0275\u0275queryRefresh(o=_.\u0275\u0275loadQuery())&&(n.fromForm=o.first)}},features:[_.\u0275\u0275InheritDefinitionFeature],decls:8,vars:1,consts:function(){let r,e,n;return r="\u8F38\u5165\u4E26\u5EFA\u7ACB",e="\u5F9E\u6A94\u6848\u5EFA\u7ACB",n="\u5F9E\u8868\u55AE\u5EFA\u7ACB",[[1,"kd-create-container"],["label",r],["label",e],["label",n]]},template:function(e,n){1&e&&(_.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-tab-group")(2,"mat-tab",1),_.\u0275\u0275element(3,"kd-create-from-input"),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(4,"mat-tab",2),_.\u0275\u0275element(5,"kd-create-from-file"),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(6,"mat-tab",3),_.\u0275\u0275element(7,"kd-create-from-form"),_.\u0275\u0275elementEnd()()()),2&e&&(_.\u0275\u0275advance(1),_.\u0275\u0275property("@.disabled",!0))},directives:[Dt.a8,c_.SP,c_.uX,m_,e_,N_],styles:[".kd-create-container[_ngcontent-%COMP%]{padding:0}.kd-create-container[_ngcontent-%COMP%]     .mat-tab-body-content{height:auto;padding:20px}"]}),t})(),data:{breadcrumb:re.SX.Create},canDeactivate:[Z]};let Pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=_.\u0275\u0275defineInjector({imports:[[I.RouterModule.forChild([Gt])],I.RouterModule]}),t})(),ht=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=_.\u0275\u0275defineInjector({providers:[Z],imports:[[__.m,j.K,ne,ee,Pt]]}),t})()}}]);